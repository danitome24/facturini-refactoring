language: php

php:
  - '7.3'

env:
  - MYSQL_USER=travis MYSQL_PASSWORD=dbpwd MYSQL_DATABASE=facturini MYSQL_HOST=127.0.0.1

notifications:
  email:
    recipients:
      - danieltomefer@gmail.com
    on_success: never
    on_failure: always

services:
  - mysql

before_install:
  - composer self-update
  - mysql -e 'CREATE DATABASE facturini'
  - echo "USE mysql;\nUPDATE user SET password=PASSWORD('dbpwd') WHERE user='travis';\nFLUSH PRIVILEGES;\n" | mysql -u root
  - mysql -u travis facturini < db/factura.sql

install:
  - composer install

script:
  - vendor/bin/behat
